<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuiteTools - Spreadsheet & Document Editor</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Top toolbar - always visible -->
        <div class="toolbar">
            <div class="toolbar-left">
                <h1>üõ†Ô∏è SuiteTools</h1>
                <span class="toolbar-badge">Spreadsheet & Docs</span>
            </div>
            <div class="toolbar-right">
                <button class="theme-toggle" id="themeToggle" title="Toggle dark/light mode">
                    <span class="theme-icon-light">‚òÄÔ∏è</span>
                    <span class="theme-icon-dark">üåô</span>
                </button>
                <div class="create-dropdown">
                    <button class="create-new-btn" id="createDropdownBtn" title="Create new file">‚ú® Create New ‚ñæ</button>
                    <div class="create-dropdown-menu" id="createDropdownMenu">
                        <button class="create-option" id="createSheetBtn">üìä New Spreadsheet</button>
                        <button class="create-option" id="createDocBtn">üìÑ New Document</button>
                    </div>
                </div>
                <button class="browse-btn" id="browseBtn">üìÅ Browse Files</button>
                <input type="file" id="fileInput" accept=".csv,.xlsx,.xls,.doc,.docx" hidden>
                <button class="clear-btn" id="clearBtn" style="display: none;">‚úï Clear</button>
            </div>
        </div>

        <!-- File info bar - shown when spreadsheet is loaded -->
        <div class="file-info" id="fileInfo" style="display: none;">
            <span class="file-name" id="fileName"></span>
            <span class="file-size" id="fileSize"></span>
            <span class="row-count" id="rowCount"></span>
            <div class="edit-controls">
                <button class="add-col-btn" id="addColBtn" title="Add new column">‚ûï Add Column</button>
                <button class="add-row-btn" id="addRowBtn" title="Add new row">‚ûï Add Row</button>
                <div class="autosave-toggle" id="autosaveToggle" title="Auto-save changes to original file">
                    <label class="toggle-switch">
                        <input type="checkbox" id="autosaveCheckbox">
                        <span class="toggle-slider"></span>
                    </label>
                    <span class="toggle-label">Auto-save</span>
                </div>
            </div>
            <div class="edit-indicator" id="editIndicator" style="display: none;">
                <span class="edit-badge" id="editBadge">‚úèÔ∏è Edited</span>
                <button class="save-btn" id="saveBtn" title="Save changes to file">üíæ Save</button>
                <button class="undo-all-btn" id="undoAllBtn" title="Undo all changes">‚Ü©Ô∏è Undo All</button>
            </div>
            <div class="save-status" id="saveStatus" style="display: none;">
                <span class="save-icon">üíæ</span>
                <span class="save-text" id="saveText">Saved</span>
            </div>
            <div class="file-actions">
                <button class="export-btn" id="exportBtn">‚¨áÔ∏è Export</button>
            </div>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="üîç Search...">
            </div>
            <button class="filter-toggle-btn" id="filterToggleBtn" title="Quick Filter">üîΩ Filter</button>
        </div>

        <!-- Document info bar - shown when document is loaded -->
        <div class="file-info doc-info" id="docInfo" style="display: none;">
            <span class="file-name" id="docFileName"></span>
            <span class="file-size" id="docFileSize"></span>
            <div class="doc-edit-indicator" id="docEditIndicator" style="display: none;">
                <span class="edit-badge">‚úèÔ∏è Edited</span>
                <button class="save-btn" id="docSaveBtn" title="Save document">üíæ Save</button>
            </div>
            <div class="file-actions">
                <button class="export-btn" id="docExportBtn">‚¨áÔ∏è Export</button>
            </div>
        </div>

        <!-- Quick Filter Panel -->
        <div class="quick-filter-panel" id="quickFilterPanel" style="display: none;">
            <div class="filter-row" id="filterRows">
                <div class="filter-group">
                    <select class="filter-column" id="filterColumn">
                        <option value="">Select Column...</option>
                    </select>
                </div>
                <div class="filter-group">
                    <select class="filter-operator" id="filterOperator">
                        <option value="equals">Equals</option>
                        <option value="not_equals">Not Equals</option>
                        <option value="contains">Contains</option>
                        <option value="not_contains">Not Contains</option>
                        <option value="starts_with">Starts With</option>
                        <option value="ends_with">Ends With</option>
                        <option value="greater_than">Greater Than</option>
                        <option value="less_than">Less Than</option>
                        <option value="greater_equal">Greater or Equal</option>
                        <option value="less_equal">Less or Equal</option>
                        <option value="is_empty">Is Empty</option>
                        <option value="is_not_empty">Is Not Empty</option>
                    </select>
                </div>
                <div class="filter-group filter-value-group">
                    <input type="text" class="filter-value" id="filterValue" placeholder="Enter value...">
                </div>
                <div class="filter-actions">
                    <button class="filter-apply-btn" id="filterApplyBtn">‚úì Apply</button>
                    <button class="filter-clear-btn" id="filterClearBtn">‚úï Clear</button>
                </div>
            </div>
            <div class="active-filters" id="activeFilters" style="display: none;">
                <span class="active-filters-label">Active:</span>
                <div class="filter-tags" id="filterTags"></div>
            </div>
        </div>

        <!-- Sheet tabs - shown for multi-sheet Excel files -->
        <div class="sheet-tabs" id="sheetTabs" style="display: none;"></div>

        <!-- SQL Query Section -->
        <div class="sql-section" id="sqlSection" style="display: none;">
            <div class="sql-header">
                <div class="sql-title">
                    <span class="sql-icon">‚ö°</span>
                    <span>SQL Query</span>
                    <span class="sql-tables-hint" id="sqlTablesHint"></span>
                </div>
                <div class="sql-actions">
                    <button class="sql-example-btn" id="sqlExamplesBtn">üìö Examples</button>
                    <button class="sql-reset-btn" id="sqlResetBtn">‚Ü∫ Reset</button>
                    <button class="sql-run-btn" id="sqlRunBtn">‚ñ∂ Run Query</button>
                </div>
            </div>
            <div class="sql-editor-wrapper" id="sqlEditorWrapper">
                <textarea id="sqlInput" class="sql-editor" placeholder="SELECT * FROM data WHERE column_name = 'value' ORDER BY column_name LIMIT 100" spellcheck="false"></textarea>
                <div class="sql-editor-footer">
                    <div class="sql-shortcuts">
                        <kbd>Ctrl</kbd>+<kbd>Enter</kbd> to run
                    </div>
                    <div class="sql-editor-info">
                        <span class="sql-line-count" id="sqlLineCount"></span>
                        <button class="sql-expand-btn" id="sqlExpandBtn" title="Toggle expanded editor (or press Esc to close)">
                            <span class="expand-icon">‚§¢</span>
                            <span class="collapse-icon" style="display:none">‚§°</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="sql-examples-panel" id="sqlExamplesPanel" style="display: none;">
                <div class="examples-section">
                    <h4>üìã Available Tables</h4>
                    <div class="tables-list" id="tablesListPanel"></div>
                </div>
                <div class="examples-section">
                    <h4>üìù SELECT & MODIFY Queries</h4>
                    <div class="examples-grid" id="basicExamples"></div>
                </div>
                <div class="examples-section" id="joinExamplesSection" style="display: none;">
                    <h4>üîó JOIN Queries (Multiple Sheets)</h4>
                    <div class="examples-grid" id="joinExamples"></div>
                </div>
                <div class="sql-modify-note">
                    <strong>üí° Tip:</strong> UPDATE, INSERT, DELETE queries modify your data directly. Use <code>Ctrl+S</code> to save or enable Auto-save.
                </div>
            </div>
            <div class="sql-result-bar" id="sqlResultBar" style="display: none;">
                <div class="sql-result-info">
                    <span class="result-icon">üìä</span>
                    <span class="result-text" id="sqlResultText"></span>
                </div>
                <button class="sql-export-btn" id="sqlExportResultsBtn">‚¨áÔ∏è Export Results</button>
            </div>
            <div class="sql-status" id="sqlStatus"></div>
        </div>

        <!-- Upload section - shown initially, hidden when file is loaded -->
        <div class="upload-section" id="uploadSection">
            <div class="upload-area" id="dropZone">
                <div class="upload-icon">üìÅ</div>
                <h3>Drag & Drop your file here</h3>
                <p>or click "Browse Files" above</p>
                <p class="file-types">Supports: CSV, XLSX, XLS, DOC, DOCX</p>
                <div class="sql-feature-badge">
                    <span>‚ö° Edit Spreadsheets & Documents</span>
                </div>
            </div>
            <div class="upload-divider">
                <span>or create new</span>
            </div>
            <div class="create-new-section">
                <div class="create-options-grid">
                    <button class="create-new-large-btn" id="createNewLargeBtn">
                        <span class="create-icon">üìä</span>
                        <span class="create-text">New Spreadsheet</span>
                        <span class="create-hint">Create tables with rows & columns</span>
                    </button>
                    <button class="create-new-large-btn create-doc-btn" id="createDocLargeBtn">
                        <span class="create-icon">üìÑ</span>
                        <span class="create-text">New Document</span>
                        <span class="create-hint">Write and format text documents</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Table container (for spreadsheets) -->
        <div class="table-container" id="tableContainer" style="display: none;"></div>

        <!-- Document editor container -->
        <div class="document-container" id="documentContainer" style="display: none;">
            <!-- Document Toolbar -->
            <div class="doc-toolbar" id="docToolbar">
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="undo" title="Undo (Ctrl+Z)">‚Ü©Ô∏è</button>
                    <button class="doc-tool-btn" data-command="redo" title="Redo (Ctrl+Y)">‚Ü™Ô∏è</button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <select class="doc-font-select" id="fontSelect" title="Font Family">
                        <option value="Arial">Arial</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Verdana">Verdana</option>
                        <option value="Courier New">Courier New</option>
                        <option value="Comic Sans MS">Comic Sans MS</option>
                    </select>
                    <select class="doc-size-select" id="sizeSelect" title="Font Size">
                        <option value="1">8</option>
                        <option value="2">10</option>
                        <option value="3" selected>12</option>
                        <option value="4">14</option>
                        <option value="5">18</option>
                        <option value="6">24</option>
                        <option value="7">36</option>
                    </select>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="bold" title="Bold (Ctrl+B)"><b>B</b></button>
                    <button class="doc-tool-btn" data-command="italic" title="Italic (Ctrl+I)"><i>I</i></button>
                    <button class="doc-tool-btn" data-command="underline" title="Underline (Ctrl+U)"><u>U</u></button>
                    <button class="doc-tool-btn" data-command="strikeThrough" title="Strikethrough"><s>S</s></button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <input type="color" class="doc-color-picker" id="textColorPicker" value="#000000" title="Text Color">
                    <input type="color" class="doc-color-picker" id="bgColorPicker" value="#ffffff" title="Highlight Color">
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="justifyLeft" title="Align Left">‚¨ÖÔ∏è</button>
                    <button class="doc-tool-btn" data-command="justifyCenter" title="Align Center">‚¨ÜÔ∏è</button>
                    <button class="doc-tool-btn" data-command="justifyRight" title="Align Right">‚û°Ô∏è</button>
                    <button class="doc-tool-btn" data-command="justifyFull" title="Justify">‚ò∞</button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="insertUnorderedList" title="Bullet List">‚Ä¢</button>
                    <button class="doc-tool-btn" data-command="insertOrderedList" title="Numbered List">1.</button>
                    <button class="doc-tool-btn" data-command="indent" title="Increase Indent">‚Üí|</button>
                    <button class="doc-tool-btn" data-command="outdent" title="Decrease Indent">|‚Üê</button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" id="insertLinkBtn" title="Insert Link">üîó</button>
                    <button class="doc-tool-btn" id="insertImageBtn" title="Insert Image">üñºÔ∏è</button>
                    <button class="doc-tool-btn" data-command="insertHorizontalRule" title="Horizontal Line">‚Äî</button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="removeFormat" title="Clear Formatting">üö´</button>
                </div>
            </div>
            <!-- Document Editor -->
            <div class="doc-editor-wrapper">
                <div class="doc-editor" id="docEditor" contenteditable="true" spellcheck="true">
                    <p>Start typing your document here...</p>
                </div>
            </div>
            <!-- Document Status Bar -->
            <div class="doc-status-bar">
                <span class="doc-word-count" id="docWordCount">0 words</span>
                <span class="doc-char-count" id="docCharCount">0 characters</span>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div class="modal-overlay" id="exportModal">
        <div class="modal">
            <div class="modal-header">
                <h2>‚¨áÔ∏è Export Data</h2>
                <button class="modal-close" id="modalClose">‚úï</button>
            </div>
            <div class="modal-body">
                <!-- Sheet Selection -->
                <div class="form-group">
                    <label>Select Sheets to Export:</label>
                    <div class="sheet-selection" id="sheetSelection">
                        <label class="radio-option">
                            <input type="radio" name="sheetOption" value="current" checked>
                            <span class="radio-label">Current Sheet Only</span>
                            <span class="sheet-name-badge" id="currentSheetName"></span>
                        </label>
                        <label class="radio-option" id="allSheetsOption">
                            <input type="radio" name="sheetOption" value="all">
                            <span class="radio-label">All Sheets</span>
                            <span class="sheet-count-badge" id="sheetCountBadge"></span>
                        </label>
                        <div class="sheets-checklist" id="sheetsChecklist" style="display: none;">
                            <label class="radio-option">
                                <input type="radio" name="sheetOption" value="selected">
                                <span class="radio-label">Select Specific Sheets:</span>
                            </label>
                            <div class="checkbox-list" id="sheetCheckboxes"></div>
                        </div>
                    </div>
                </div>

                <!-- Format Selection -->
                <div class="form-group">
                    <label>Export Format:</label>
                    <div class="format-grid" id="formatGrid">
                        <button class="format-option selected" data-format="xlsx">
                            <span class="format-icon">üìä</span>
                            <span class="format-name">Excel</span>
                            <span class="format-ext">.xlsx</span>
                        </button>
                        <button class="format-option" data-format="xls">
                            <span class="format-icon">üìó</span>
                            <span class="format-name">Excel 97-03</span>
                            <span class="format-ext">.xls</span>
                        </button>
                        <button class="format-option" data-format="csv">
                            <span class="format-icon">üìÑ</span>
                            <span class="format-name">CSV</span>
                            <span class="format-ext">.csv</span>
                        </button>
                        <button class="format-option" data-format="json">
                            <span class="format-icon">üìã</span>
                            <span class="format-name">JSON</span>
                            <span class="format-ext">.json</span>
                        </button>
                        <button class="format-option" data-format="html">
                            <span class="format-icon">üåê</span>
                            <span class="format-name">HTML</span>
                            <span class="format-ext">.html</span>
                        </button>
                    </div>
                    <p class="format-note" id="formatNote"></p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" id="exportCancel">Cancel</button>
                <button class="btn-export" id="exportConfirm">‚¨áÔ∏è Export</button>
            </div>
        </div>
    </div>

    <!-- SheetJS library for Excel support -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <!-- AlaSQL for SQL query support -->
    <script src="https://cdn.jsdelivr.net/npm/alasql@4.3.0/dist/alasql.min.js"></script>
    <!-- Mammoth.js for DOCX support -->
    <script src="https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js"></script>
    <!-- docx library for creating DOCX files -->
    <script src="https://cdn.jsdelivr.net/npm/docx@8.2.2/build/index.umd.min.js"></script>
    
    <!-- Application Modules -->
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/dom.js"></script>
    <script src="js/filter.js"></script>
    <script src="js/sql.js"></script>
    <script src="js/spreadsheet.js"></script>
    <script src="js/document.js"></script>
    <script src="js/file-handler.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
