<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuiteTools - Spreadsheet, Document & Slides Editor</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Top toolbar - always visible -->
        <div class="toolbar">
            <div class="toolbar-left">
                <h1 class="app-logo" id="appLogo" title="Return to home">üõ†Ô∏è SuiteTools</h1>
                <span class="toolbar-badge">Sheets, Docs & Slides</span>
            </div>
            <div class="toolbar-right">
                <button class="theme-toggle" id="themeToggle" title="Toggle dark/light mode">
                    <span class="theme-icon-light">‚òÄÔ∏è</span>
                    <span class="theme-icon-dark">üåô</span>
                </button>
                <div class="create-dropdown">
                    <button class="create-new-btn" id="createDropdownBtn" title="Create new file">‚ú® Create New ‚ñæ</button>
                    <div class="create-dropdown-menu" id="createDropdownMenu">
                        <button class="create-option" id="createSheetBtn">üìä New Spreadsheet</button>
                        <button class="create-option" id="createDocBtn">üìÑ New Document</button>
                        <button class="create-option" id="createSlidesBtn">üìΩÔ∏è New Presentation</button>
                    </div>
                </div>
                <button class="browse-btn" id="browseBtn">üìÅ Browse Files</button>
                <input type="file" id="fileInput" accept=".csv,.xlsx,.xls,.doc,.docx,.pptx,.ppt" hidden>
                <button class="clear-btn" id="clearBtn" style="display: none;">‚úï Clear</button>
            </div>
        </div>

        <!-- File info bar - shown when spreadsheet is loaded -->
        <div class="file-info" id="fileInfo" style="display: none;">
            <span class="file-name" id="fileName"></span>
            <span class="file-size" id="fileSize"></span>
            <span class="row-count" id="rowCount"></span>
            <div class="edit-controls">
                <button class="add-col-btn" id="addColBtn" title="Add new column">‚ûï Add Column</button>
                <button class="add-row-btn" id="addRowBtn" title="Add new row">‚ûï Add Row</button>
                <div class="autosave-toggle" id="autosaveToggle" title="Auto-save changes to original file">
                    <label class="toggle-switch">
                        <input type="checkbox" id="autosaveCheckbox">
                        <span class="toggle-slider"></span>
                    </label>
                    <span class="toggle-label">Auto-save</span>
                </div>
            </div>
            <div class="edit-indicator" id="editIndicator" style="display: none;">
                <span class="edit-badge" id="editBadge">‚úèÔ∏è Edited</span>
                <button class="save-btn" id="saveBtn" title="Save changes to file">üíæ Save</button>
                <button class="undo-all-btn" id="undoAllBtn" title="Undo all changes">‚Ü©Ô∏è Undo All</button>
            </div>
            <div class="save-status" id="saveStatus" style="display: none;">
                <span class="save-icon">üíæ</span>
                <span class="save-text" id="saveText">Saved</span>
            </div>
            <div class="file-actions">
                <button class="export-btn" id="exportBtn">‚¨áÔ∏è Export</button>
            </div>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="üîç Search...">
            </div>
            <button class="filter-toggle-btn" id="filterToggleBtn" title="Quick Filter">üîΩ Filter</button>
        </div>

        <!-- Document info bar - shown when document is loaded -->
        <div class="file-info doc-info" id="docInfo" style="display: none;">
            <span class="file-name" id="docFileName"></span>
            <span class="file-size" id="docFileSize"></span>
            <div class="doc-edit-indicator" id="docEditIndicator" style="display: none;">
                <span class="edit-badge">‚úèÔ∏è Edited</span>
                <button class="save-btn" id="docSaveBtn" title="Save document">üíæ Save</button>
            </div>
            <div class="file-actions">
                <button class="export-btn" id="docExportBtn">‚¨áÔ∏è Export</button>
            </div>
        </div>

        <!-- Slides info bar - shown when presentation is loaded -->
        <div class="file-info slides-info" id="slidesInfo" style="display: none;">
            <span class="file-name" id="slidesFileName"></span>
            <span class="file-size" id="slidesFileSize"></span>
            <div class="slides-edit-indicator" id="slidesEditIndicator" style="display: none;">
                <span class="edit-badge">‚úèÔ∏è Edited</span>
                <button class="save-btn" id="slidesSaveBtn" title="Save presentation">üíæ Save</button>
            </div>
            <div class="slides-controls">
                <button class="slide-nav-btn" id="prevSlideBtn" title="Previous slide (‚Üê)">‚óÄ</button>
                <span class="slide-counter" id="slideCounter">1 / 1</span>
                <button class="slide-nav-btn" id="nextSlideBtn" title="Next slide (‚Üí)">‚ñ∂</button>
            </div>
            <div class="slides-toolbar">
                <button class="slide-tool-btn" id="addSlideBtn" title="Add new slide">‚ûï Add</button>
                <button class="slide-tool-btn" id="duplicateSlideBtn" title="Duplicate current slide">üìã Duplicate</button>
                <button class="slide-tool-btn" id="moveSlideUpBtn" title="Move slide up">‚¨ÜÔ∏è</button>
                <button class="slide-tool-btn" id="moveSlideDownBtn" title="Move slide down">‚¨áÔ∏è</button>
                <button class="slide-tool-btn danger" id="deleteSlideBtn" title="Delete current slide">üóëÔ∏è</button>
            </div>
            <div class="file-actions">
                <button class="slideshow-btn" id="slideshowBtn" title="Start slideshow (F5)">‚ñ∂Ô∏è Slideshow</button>
                <button class="export-btn" id="slidesExportBtn">‚¨áÔ∏è Export</button>
            </div>
        </div>

        <!-- Quick Filter Panel -->
        <div class="quick-filter-panel" id="quickFilterPanel" style="display: none;">
            <div class="filter-row" id="filterRows">
                <div class="filter-group">
                    <select class="filter-column" id="filterColumn">
                        <option value="">Select Column...</option>
                    </select>
                </div>
                <div class="filter-group">
                    <select class="filter-operator" id="filterOperator">
                        <option value="equals">Equals</option>
                        <option value="not_equals">Not Equals</option>
                        <option value="contains">Contains</option>
                        <option value="not_contains">Not Contains</option>
                        <option value="starts_with">Starts With</option>
                        <option value="ends_with">Ends With</option>
                        <option value="greater_than">Greater Than</option>
                        <option value="less_than">Less Than</option>
                        <option value="greater_equal">Greater or Equal</option>
                        <option value="less_equal">Less or Equal</option>
                        <option value="is_empty">Is Empty</option>
                        <option value="is_not_empty">Is Not Empty</option>
                    </select>
                </div>
                <div class="filter-group filter-value-group">
                    <input type="text" class="filter-value" id="filterValue" placeholder="Enter value...">
                </div>
                <div class="filter-actions">
                    <button class="filter-apply-btn" id="filterApplyBtn">‚úì Apply</button>
                    <button class="filter-clear-btn" id="filterClearBtn">‚úï Clear</button>
                </div>
            </div>
            <div class="active-filters" id="activeFilters" style="display: none;">
                <span class="active-filters-label">Active:</span>
                <div class="filter-tags" id="filterTags"></div>
            </div>
        </div>

        <!-- Sheet tabs - shown for multi-sheet Excel files -->
        <div class="sheet-tabs" id="sheetTabs" style="display: none;"></div>

        <!-- SQL Query Section -->
        <div class="sql-section" id="sqlSection" style="display: none;">
            <div class="sql-header">
                <div class="sql-title">
                    <span class="sql-icon">‚ö°</span>
                    <span>SQL Query</span>
                    <span class="sql-tables-hint" id="sqlTablesHint"></span>
                </div>
                <div class="sql-actions">
                    <button class="sql-example-btn" id="sqlExamplesBtn">üìö Examples</button>
                    <button class="sql-reset-btn" id="sqlResetBtn">‚Ü∫ Reset</button>
                    <button class="sql-run-btn" id="sqlRunBtn">‚ñ∂ Run Query</button>
                </div>
            </div>
            <div class="sql-editor-wrapper" id="sqlEditorWrapper">
                <textarea id="sqlInput" class="sql-editor" placeholder="SELECT * FROM data WHERE column_name = 'value' ORDER BY column_name LIMIT 100" spellcheck="false"></textarea>
                <div class="sql-editor-footer">
                    <div class="sql-shortcuts">
                        <kbd>Ctrl</kbd>+<kbd>Enter</kbd> to run
                    </div>
                    <div class="sql-editor-info">
                        <span class="sql-line-count" id="sqlLineCount"></span>
                        <button class="sql-expand-btn" id="sqlExpandBtn" title="Toggle expanded editor (or press Esc to close)">
                            <span class="expand-icon">‚§¢</span>
                            <span class="collapse-icon" style="display:none">‚§°</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="sql-examples-panel" id="sqlExamplesPanel" style="display: none;">
                <div class="examples-section">
                    <h4>üìã Available Tables</h4>
                    <div class="tables-list" id="tablesListPanel"></div>
                </div>
                <div class="examples-section">
                    <h4>üìù SELECT & MODIFY Queries</h4>
                    <div class="examples-grid" id="basicExamples"></div>
                </div>
                <div class="examples-section" id="joinExamplesSection" style="display: none;">
                    <h4>üîó JOIN Queries (Multiple Sheets)</h4>
                    <div class="examples-grid" id="joinExamples"></div>
                </div>
                <div class="sql-modify-note">
                    <strong>üí° Tip:</strong> UPDATE, INSERT, DELETE queries modify your data directly. Use <code>Ctrl+S</code> to save or enable Auto-save.
                </div>
            </div>
            <div class="sql-result-bar" id="sqlResultBar" style="display: none;">
                <div class="sql-result-info">
                    <span class="result-icon">üìä</span>
                    <span class="result-text" id="sqlResultText"></span>
                </div>
                <button class="sql-export-btn" id="sqlExportResultsBtn">‚¨áÔ∏è Export Results</button>
            </div>
            <div class="sql-status" id="sqlStatus"></div>
        </div>

        <!-- Upload section - shown initially, hidden when file is loaded -->
        <div class="upload-section" id="uploadSection">
            <div class="home-panels">
                <!-- Open File Panel -->
                <div class="home-panel open-panel">
                    <div class="home-panel-header">
                        <span class="home-panel-icon">üìÇ</span>
                        <h3>Open File</h3>
                    </div>
                    <div class="upload-area" id="dropZone">
                        <div class="upload-icon">üìÅ</div>
                        <h4>Drag & Drop your file here</h4>
                        <p>or click to browse</p>
                        <p class="file-types">CSV, XLSX, XLS, DOC, DOCX, PPT, PPTX</p>
                    </div>
                </div>

                <div class="home-divider">
                    <span>or</span>
                </div>

                <!-- Create New Panel -->
                <div class="home-panel create-panel">
                    <div class="home-panel-header">
                        <span class="home-panel-icon">‚ú®</span>
                        <h3>Create New</h3>
                    </div>
                    <div class="create-options-list">
                        <button class="create-option-btn" id="createNewLargeBtn">
                            <span class="create-option-icon">üìä</span>
                            <div class="create-option-info">
                                <span class="create-option-title">Spreadsheet</span>
                                <span class="create-option-desc">Tables with rows & columns</span>
                            </div>
                            <span class="create-option-arrow">‚Üí</span>
                        </button>
                        <button class="create-option-btn" id="createDocLargeBtn">
                            <span class="create-option-icon">üìÑ</span>
                            <div class="create-option-info">
                                <span class="create-option-title">Document</span>
                                <span class="create-option-desc">Write and format text</span>
                            </div>
                            <span class="create-option-arrow">‚Üí</span>
                        </button>
                        <button class="create-option-btn" id="createSlidesLargeBtn">
                            <span class="create-option-icon">üìΩÔ∏è</span>
                            <div class="create-option-info">
                                <span class="create-option-title">Presentation</span>
                                <span class="create-option-desc">Slideshows & presentations</span>
                            </div>
                            <span class="create-option-arrow">‚Üí</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Table container (for spreadsheets) -->
        <div class="table-container" id="tableContainer" style="display: none;"></div>

        <!-- Document editor container -->
        <div class="document-container" id="documentContainer" style="display: none;">
            <!-- Document Toolbar -->
            <div class="doc-toolbar" id="docToolbar">
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="undo" title="Undo (Ctrl+Z)">‚Ü©Ô∏è</button>
                    <button class="doc-tool-btn" data-command="redo" title="Redo (Ctrl+Y)">‚Ü™Ô∏è</button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <select class="doc-font-select" id="fontSelect" title="Font Family">
                        <option value="Arial">Arial</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Verdana">Verdana</option>
                        <option value="Courier New">Courier New</option>
                        <option value="Comic Sans MS">Comic Sans MS</option>
                    </select>
                    <select class="doc-size-select" id="sizeSelect" title="Font Size">
                        <option value="1">8</option>
                        <option value="2">10</option>
                        <option value="3" selected>12</option>
                        <option value="4">14</option>
                        <option value="5">18</option>
                        <option value="6">24</option>
                        <option value="7">36</option>
                    </select>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="bold" title="Bold (Ctrl+B)"><b>B</b></button>
                    <button class="doc-tool-btn" data-command="italic" title="Italic (Ctrl+I)"><i>I</i></button>
                    <button class="doc-tool-btn" data-command="underline" title="Underline (Ctrl+U)"><u>U</u></button>
                    <button class="doc-tool-btn" data-command="strikeThrough" title="Strikethrough"><s>S</s></button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <input type="color" class="doc-color-picker" id="textColorPicker" value="#000000" title="Text Color">
                    <input type="color" class="doc-color-picker" id="bgColorPicker" value="#ffffff" title="Highlight Color">
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="justifyLeft" title="Align Left">‚¨ÖÔ∏è</button>
                    <button class="doc-tool-btn" data-command="justifyCenter" title="Align Center">‚¨ÜÔ∏è</button>
                    <button class="doc-tool-btn" data-command="justifyRight" title="Align Right">‚û°Ô∏è</button>
                    <button class="doc-tool-btn" data-command="justifyFull" title="Justify">‚ò∞</button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="insertUnorderedList" title="Bullet List">‚Ä¢</button>
                    <button class="doc-tool-btn" data-command="insertOrderedList" title="Numbered List">1.</button>
                    <button class="doc-tool-btn" data-command="indent" title="Increase Indent">‚Üí|</button>
                    <button class="doc-tool-btn" data-command="outdent" title="Decrease Indent">|‚Üê</button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" id="insertLinkBtn" title="Insert Link">üîó</button>
                    <button class="doc-tool-btn" id="insertImageBtn" title="Insert Image">üñºÔ∏è</button>
                    <button class="doc-tool-btn" data-command="insertHorizontalRule" title="Horizontal Line">‚Äî</button>
                </div>
                <div class="doc-toolbar-divider"></div>
                <div class="doc-toolbar-group">
                    <button class="doc-tool-btn" data-command="removeFormat" title="Clear Formatting">üö´</button>
                </div>
            </div>
            <!-- Document Editor -->
            <div class="doc-editor-wrapper">
                <div class="doc-editor" id="docEditor" contenteditable="true" spellcheck="true">
                    <p>Start typing your document here...</p>
                </div>
            </div>
            <!-- Document Status Bar -->
            <div class="doc-status-bar">
                <span class="doc-word-count" id="docWordCount">0 words</span>
                <span class="doc-char-count" id="docCharCount">0 characters</span>
            </div>
        </div>

        <!-- Slides container -->
        <div class="slides-container" id="slidesContainer" style="display: none;">
            <!-- Slides thumbnails sidebar -->
            <div class="slides-sidebar">
                <div class="slides-sidebar-header">
                    <span>üìΩÔ∏è Slides</span>
                </div>
                <div class="slides-thumbnails" id="slidesThumbnails">
                    <!-- Thumbnails will be rendered here -->
                </div>
            </div>
            <!-- Main slide viewer -->
            <div class="slides-main">
                <div class="slides-viewer" id="slidesViewer">
                    <!-- Current slide will be rendered here -->
                </div>
                <div class="slides-status-bar">
                    <span class="slides-hint">Click text to edit ‚Ä¢ ‚Üê ‚Üí to navigate ‚Ä¢ Ctrl+D to duplicate ‚Ä¢ Ctrl+S to save</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Slides Export Modal -->
    <div class="modal-overlay" id="slidesExportModal">
        <div class="modal slides-export-modal">
            <div class="modal-header">
                <h3>üìΩÔ∏è Export Presentation</h3>
                <button class="modal-close" id="slidesExportModalClose">√ó</button>
            </div>
            <div class="modal-body">
                <p class="export-description">Choose export format:</p>
                <div class="slides-export-options">
                    <button class="slides-export-option" id="exportPptxBtn">
                        <span class="export-icon">üìä</span>
                        <span class="export-label">PowerPoint</span>
                        <span class="export-ext">.pptx</span>
                    </button>
                    <button class="slides-export-option" id="exportPdfBtn">
                        <span class="export-icon">üìÑ</span>
                        <span class="export-label">PDF Document</span>
                        <span class="export-ext">.pdf</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Draggable Color Picker Panel -->
    <div class="color-picker-panel" id="colorPickerPanel">
        <div class="color-picker-header" id="colorPickerHeader">
            <span class="color-picker-title">üé® Slide Style</span>
            <button class="color-picker-close" id="colorPickerClose">‚úï</button>
        </div>
        <div class="color-picker-body">
            <!-- Text Color Section -->
            <div class="color-picker-section">
                <span class="color-section-label">‚úèÔ∏è Text Color</span>
                <div class="color-picker-main">
                    <input type="color" id="slideTextColorInput" value="#1a1a2e">
                    <span class="color-picker-value" id="textColorPickerValue">#1a1a2e</span>
                    <button class="auto-color-btn" id="autoTextColorBtn" title="Auto-detect based on background">Auto</button>
                </div>
                <div class="text-color-presets">
                    <button class="color-preset text-preset" data-color="#1a1a2e" style="background: #1a1a2e;" title="Dark"></button>
                    <button class="color-preset text-preset" data-color="#333333" style="background: #333333;" title="Charcoal"></button>
                    <button class="color-preset text-preset" data-color="#ffffff" style="background: #ffffff;" title="White"></button>
                    <button class="color-preset text-preset" data-color="#f8f9fa" style="background: #f8f9fa;" title="Off-White"></button>
                    <button class="color-preset text-preset" data-color="#667eea" style="background: #667eea;" title="Purple"></button>
                    <button class="color-preset text-preset" data-color="#e94560" style="background: #e94560;" title="Red"></button>
                </div>
            </div>
            
            <!-- Background Image Section -->
            <div class="color-picker-section">
                <span class="color-section-label">üñºÔ∏è Background Image</span>
                <div class="bg-image-controls">
                    <div class="bg-image-preview" id="bgImagePreview">
                        <span class="bg-image-placeholder">No image</span>
                    </div>
                    <div class="bg-image-buttons">
                        <label class="bg-image-btn upload" title="Upload image">
                            üì∑ Upload
                            <input type="file" id="bgImageInput" accept="image/*" hidden>
                        </label>
                        <button class="bg-image-btn remove" id="bgImageRemove" title="Remove image">üóëÔ∏è Remove</button>
                    </div>
                </div>
            </div>
            
            <!-- Background Color Section -->
            <div class="color-picker-section">
                <span class="color-section-label">üé® Background Color</span>
                <div class="color-picker-main">
                    <input type="color" id="slideBgColorInput" value="#ffffff">
                    <span class="color-picker-value" id="colorPickerValue">#ffffff</span>
                </div>
                <div class="color-picker-presets">
                    <button class="color-preset bg-preset" data-color="#ffffff" style="background: #ffffff;" title="White"></button>
                    <button class="color-preset bg-preset" data-color="#f8f9fa" style="background: #f8f9fa;" title="Light Gray"></button>
                    <button class="color-preset bg-preset" data-color="#e9ecef" style="background: #e9ecef;" title="Gray"></button>
                    <button class="color-preset bg-preset" data-color="#212529" style="background: #212529;" title="Dark"></button>
                    <button class="color-preset bg-preset" data-color="#1a1a2e" style="background: #1a1a2e;" title="Navy Dark"></button>
                    <button class="color-preset bg-preset" data-color="#0f3460" style="background: #0f3460;" title="Deep Blue"></button>
                    <button class="color-preset bg-preset" data-color="#e94560" style="background: #e94560;" title="Red"></button>
                    <button class="color-preset bg-preset" data-color="#ff6b6b" style="background: #ff6b6b;" title="Coral"></button>
                    <button class="color-preset bg-preset" data-color="#feca57" style="background: #feca57;" title="Yellow"></button>
                    <button class="color-preset bg-preset" data-color="#48dbfb" style="background: #48dbfb;" title="Cyan"></button>
                    <button class="color-preset bg-preset" data-color="#1dd1a1" style="background: #1dd1a1;" title="Mint"></button>
                    <button class="color-preset bg-preset" data-color="#5f27cd" style="background: #5f27cd;" title="Purple"></button>
                </div>
            </div>
            
            <!-- Gradients Section -->
            <div class="color-picker-section">
                <span class="color-section-label">üåà Gradients</span>
                <div class="gradient-presets">
                    <button class="gradient-preset" data-gradient="linear-gradient(135deg, #667eea 0%, #764ba2 100%)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" title="Purple Gradient"></button>
                    <button class="gradient-preset" data-gradient="linear-gradient(135deg, #f093fb 0%, #f5576c 100%)" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);" title="Pink Gradient"></button>
                    <button class="gradient-preset" data-gradient="linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);" title="Blue Gradient"></button>
                    <button class="gradient-preset" data-gradient="linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);" title="Green Gradient"></button>
                    <button class="gradient-preset" data-gradient="linear-gradient(135deg, #fa709a 0%, #fee140 100%)" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);" title="Sunset Gradient"></button>
                    <button class="gradient-preset" data-gradient="linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);" title="Soft Gradient"></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Fullscreen Slideshow Mode -->
    <div class="slideshow-overlay" id="slideshowOverlay">
        <div class="slideshow-container" id="slideshowContainer">
            <!-- Slide content will be rendered here -->
        </div>
        <div class="slideshow-controls">
            <button class="slideshow-control-btn" id="slideshowPrev" title="Previous (‚Üê)">‚óÄ</button>
            <span class="slideshow-counter" id="slideshowCounter">1 / 1</span>
            <button class="slideshow-control-btn" id="slideshowNext" title="Next (‚Üí)">‚ñ∂</button>
            <div class="slideshow-controls-right">
                <button class="slideshow-control-btn" id="slideshowAutoplay" title="Auto-play">‚èµ</button>
                <button class="slideshow-control-btn" id="slideshowExit" title="Exit (Esc)">‚úï</button>
            </div>
        </div>
        <div class="slideshow-progress">
            <div class="slideshow-progress-bar" id="slideshowProgressBar"></div>
        </div>
    </div>

    <!-- Confirm/Alert Modal -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal confirm-modal">
            <div class="confirm-modal-header">
                <span class="confirm-modal-icon" id="confirmModalIcon">‚ö†Ô∏è</span>
                <h2 id="confirmModalTitle">Confirm</h2>
            </div>
            <div class="confirm-modal-body">
                <p id="confirmModalMessage">Are you sure?</p>
            </div>
            <div class="confirm-modal-footer">
                <button class="btn-third" id="confirmModalThird" style="display: none;">Cancel</button>
                <button class="btn-cancel" id="confirmModalCancel">Discard</button>
                <button class="btn-confirm" id="confirmModalOk">Save</button>
            </div>
        </div>
    </div>

    <!-- Prompt Modal -->
    <div class="modal-overlay" id="promptModal">
        <div class="modal prompt-modal">
            <div class="confirm-modal-header">
                <span class="confirm-modal-icon" id="promptModalIcon">‚úèÔ∏è</span>
                <h2 id="promptModalTitle">Input</h2>
            </div>
            <div class="confirm-modal-body">
                <p id="promptModalMessage">Enter value:</p>
                <input type="text" class="prompt-input" id="promptModalInput" placeholder="">
            </div>
            <div class="confirm-modal-footer">
                <button class="btn-cancel" id="promptModalCancel">Cancel</button>
                <button class="btn-confirm" id="promptModalOk">OK</button>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div class="modal-overlay" id="exportModal">
        <div class="modal">
            <div class="modal-header">
                <h2>‚¨áÔ∏è Export Data</h2>
                <button class="modal-close" id="modalClose">‚úï</button>
            </div>
            <div class="modal-body">
                <!-- Sheet Selection -->
                <div class="form-group">
                    <label>Select Sheets to Export:</label>
                    <div class="sheet-selection" id="sheetSelection">
                        <label class="radio-option">
                            <input type="radio" name="sheetOption" value="current" checked>
                            <span class="radio-label">Current Sheet Only</span>
                            <span class="sheet-name-badge" id="currentSheetName"></span>
                        </label>
                        <label class="radio-option" id="allSheetsOption">
                            <input type="radio" name="sheetOption" value="all">
                            <span class="radio-label">All Sheets</span>
                            <span class="sheet-count-badge" id="sheetCountBadge"></span>
                        </label>
                        <div class="sheets-checklist" id="sheetsChecklist" style="display: none;">
                            <label class="radio-option">
                                <input type="radio" name="sheetOption" value="selected">
                                <span class="radio-label">Select Specific Sheets:</span>
                            </label>
                            <div class="checkbox-list" id="sheetCheckboxes"></div>
                        </div>
                    </div>
                </div>

                <!-- Format Selection -->
                <div class="form-group">
                    <label>Export Format:</label>
                    <div class="format-grid" id="formatGrid">
                        <button class="format-option selected" data-format="xlsx">
                            <span class="format-icon">üìä</span>
                            <span class="format-name">Excel</span>
                            <span class="format-ext">.xlsx</span>
                        </button>
                        <button class="format-option" data-format="xls">
                            <span class="format-icon">üìó</span>
                            <span class="format-name">Excel 97-03</span>
                            <span class="format-ext">.xls</span>
                        </button>
                        <button class="format-option" data-format="csv">
                            <span class="format-icon">üìÑ</span>
                            <span class="format-name">CSV</span>
                            <span class="format-ext">.csv</span>
                        </button>
                        <button class="format-option" data-format="json">
                            <span class="format-icon">üìã</span>
                            <span class="format-name">JSON</span>
                            <span class="format-ext">.json</span>
                        </button>
                        <button class="format-option" data-format="html">
                            <span class="format-icon">üåê</span>
                            <span class="format-name">HTML</span>
                            <span class="format-ext">.html</span>
                        </button>
                    </div>
                    <p class="format-note" id="formatNote"></p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" id="exportCancel">Cancel</button>
                <button class="btn-export" id="exportConfirm">‚¨áÔ∏è Export</button>
            </div>
        </div>
    </div>

    <!-- SheetJS library for Excel support -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <!-- AlaSQL for SQL query support -->
    <script src="https://cdn.jsdelivr.net/npm/alasql@4.3.0/dist/alasql.min.js"></script>
    <!-- Mammoth.js for DOCX support -->
    <script src="https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js"></script>
    <!-- docx library for creating DOCX files -->
    <script src="https://cdn.jsdelivr.net/npm/docx@8.2.2/build/index.umd.min.js"></script>
    <!-- JSZip for reading PPTX files -->
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <!-- PptxGenJS for creating PPTX files -->
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <!-- html2canvas for rendering HTML to canvas -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <!-- jsPDF for PDF generation -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    
    <!-- Application Modules -->
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/dom.js"></script>
    <script src="js/filter.js"></script>
    <script src="js/sql.js"></script>
    <script src="js/spreadsheet.js"></script>
    <script src="js/document.js"></script>
    <script src="js/slides.js"></script>
    <script src="js/file-handler.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
